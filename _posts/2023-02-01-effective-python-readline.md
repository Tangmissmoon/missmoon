---
title: ç™¾æœ¬æŠ€æœ¯ä½¬Â·ç¬¬ä¸€æœ¬ã€ŠEffective Pythonã€‹
description: ç§ä¸€æ£µæ ‘ï¼Œæœ€å¥½çš„æ—¶é—´æ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨ã€‚
categories:
 - è®°å½•
tags:
- å¿ƒå¾—
- ç¬”è®°
- é˜…è¯»
- Python
---

> åˆ»æ„ç»ƒä¹ ï¼Œæ¯æ—¥ç²¾è¿›. æ‰¾å‡ºé—ªå…‰ç‚¹.

<!-- more begin-out-is-great -->

ğŸ“˜åŸºæœ¬ä¿¡æ¯
    ä¹¦åï¼šã€ŠEffective Pythonã€‹ç¼–å†™é«˜è´¨é‡Pythonä»£ç çš„90ä¸ªæœ‰æ•ˆæ–¹æ³•
    
    ä½œè€…ï¼šBrett Slatkin çˆ±é£ç¿”è¯‘ç¬¬2ç‰ˆ
    ç±»åˆ«ï¼š#ç¼–ç¨‹æŠ€æœ¯ 
    é˜…è¯»æ—¶é—´ï¼šå·¥ä½œæ—¥æ¯å¤©æ™šä¸Šä¸€ä¸ªçŸ¥è¯†ç‚¹
    é‡è¦ä¿¡æ¯ï¼š
    ï½œ Pythonæå‡ç±»çš„ä¹¦ç±ï¼Œç®¡ç†ç¼–ç¨‹ä¹ æƒ¯
    ç›¸å…³é˜…è¯»ï¼š
ğŸ”§é˜…è¯»æ–¹å¼
    ç†è§£ä¼šç”¨çš„ï¼Œé˜…è¯»ç»†èŠ‚ï¼ŒåŠ æ·±å°è±¡
    ä¸å¤ªä¼šçš„ï¼Œç•¥çŸ¥ä¸€äºŒï¼Œå·¥åŒ æ‰‹å†™ç¬”è®°+æ‰‹å·¥ç»ƒä¹ ï¼ˆä»£ç ï¼‰

1. 

3. 
4. 
5. s
6. s
7. s
8. s
9. s
10. s
11. 
12. ç‰¹æ®Šæ­¥è¿›çš„åˆ‡ç‰‡æ–¹å¼ï¼šsomelist[start:end:stride]ï¼Œ-1åè½¬çš„ç”¨æ³•ï¼Œå¯¹bytesç±»å‹çš„å­—ç¬¦ä¸²ã€Unicodeç±»å‹çš„å­—ç¬¦ä¸²éƒ½å¯ä»¥ï¼Œä¸æ”¯æŒUTF-8çš„å­—èŠ‚æ•°æ®ï¼Œå°½é‡ä¸è¦åŒæ—¶å†™æ»¡æ ‡è®°çš„ä¸‰ä¸ªå‚æ•°ï¼Œéš¾ä»¥ç†è§£ï¼Œå¦‚æœ‰éœ€è¦ï¼Œä½¿ç”¨itertoolså†…ç½®æ¨¡å—é‡Œçš„isliceæ–¹æ³•

13. ç”¨æ˜Ÿå·çš„unpackingæ“ä½œæ•è·å…ƒç´ ï¼šone,two,*three=[1,2,3,4]

14. ç”¨`sort`æ–¹æ³•çš„keyå‚æ•°æ¥è¡¨ç¤ºå¤æ‚çš„æ’åºé€»è¾‘
```python
Class Tool:
    def __init__(self, name, weight):
        self.name = name
        self.weight = weight
    
    def __repr__(self):
        return f"Tool({self.name!r}, {self.weight})"
# Traceback        
tools.sort()
power_tolls = [
    Tool('drill', 4),
    Tool('circular saw', 5),
    Tool('jackhammer', 40),
    Tool('sander', 4),
]
power_tools.sort(key=lambda x:(-x.weight, x.name))
power_tools.sort(key=lambda x:(-x.weight, x.name) reverse=True) # error
```
15. ç¬¬15æ¡ï¼Œä¸è¦è¿‡åˆ†ä¾èµ–ç»™å­—å…¸æ·»åŠ æ¡ç›®æ—¶æ‰€ç”¨çš„é¡ºåºï¼Œ`3.5`ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œé¡ºåºä¸å®šï¼Œè¿™è·Ÿå­—å…¸ç±»å‹ä»¥å‰è·Ÿå“ˆå¸Œè¡¨å®ç°æœ‰å…³ï¼Œå†…ç½®çš„`hash`å‡½æ•°å’Œéšæœºç§å­æ•°æ¥ç¡®å®šï¼Œå› æ­¤`dict`ç›¸å…³çš„æ–¹æ³•éƒ½ä¸èƒ½ä¿è¯å›ºå®šçš„é¡ºåºï¼Œè€Œ`3.6`å¼€å§‹ï¼Œå­—å…¸ä¼šä¿ç•™æ·»åŠ æ—¶æ‰€ä½¿ç”¨çš„é¡ºåºã€‚

    >å†…ç½®çš„`Collections`æ¨¡å—æä¾›çš„OrderedDictï¼Œè¡Œä¸ºå’Œ3.7ç‰ˆæœ¬åçš„æ ‡å‡†dictå¾ˆåƒï¼Œä½†æ€§èƒ½æœ‰è¾ƒåˆ°åŒºåˆ«ã€‚å®ç°LRUç¼“å­˜ï¼Œï¼ˆleast-recently-usedç¼“å­˜ï¼‰OrderedDictæ¯”dictç±»å‹æ›´åˆé€‚ã€‚

    >è¡¥å……ï¼Œå¦‚æœä¸æƒ³æŠŠè¿™ç§ä¸æ ‡å‡†å­—å…¸ç›¸ä¼¼çš„ç±»å‹å½“ä½œæ ‡å‡†å­—å…¸å¤„ç†çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ä¸‰ç§åŠæ³•ï¼š
    > - ä¸ä¾èµ–æ’å…¥æ—¶çš„é¡ºåºç¼–ç ï¼›
    > - åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ˜ç¡®åˆ¤æ–­å­—å…¸ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨`instance`æ–¹æ³•ï¼›
    > - ç»™ä»£ç æ·»åŠ ç±»å‹æ³¨è§£å¹¶ä½œé™æ€åˆ†æã€‚

    >å†…ç½®çš„`Collections`æ¨¡å—æä¾›çš„OrderedDictï¼Œè¡Œä¸ºå’Œ3.7ç‰ˆæœ¬åçš„æ ‡å‡†dictå¾ˆåƒï¼Œä½†æ€§èƒ½æœ‰è¾ƒåˆ°åŒºåˆ«ã€‚å®ç°LRUç¼“å­˜ï¼Œï¼ˆleast-recently-usedç¼“å­˜ï¼‰OrderedDictæ¯”dictç±»å‹æ›´åˆé€‚ã€‚

16. `get` å¤„ç†é”®ä¸åœ¨å­—å…¸é‡Œçš„æƒ…å†µï¼Œä¸ä½¿ç”¨`in`å’Œ`KeyError`ï¼Œå­—å…¸æœ‰ä¸‰ç§äº¤äº’æ“ä½œï¼Œè®¿é—®ã€èµ‹å€¼ä»¥åŠåˆ é™¤é”®å€¼å¯¹ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯`dict.setdefault(key, value)`ã€‚
    
    - å¦‚æœè·Ÿé”®ç›¸å…³è”çš„å€¼ï¼Œæ˜¯åŸºæœ¬ç±»å‹ï¼Œé€‰`get`ï¼›
    - æ„é€ å¼€é”€å¤§/å®¹æ˜“å¼‚å¸¸çš„ç±»å‹ï¼Œå’Œèµ‹å€¼è¡¨è¾¾å¼ç»“åˆèµ·æ¥ç”¨ `dict[key] = values = []`
    - `setdefault` æ–¹æ¡ˆ vs `defaultdict`

17. ç”¨`defaultdict` å¤„ç†å†…éƒ¨çŠ¶æ€ä¸­ç¼ºå¤±çš„å…ƒç´ ï¼Œä¸ä½¿ç”¨`setdefault`ï¼Œæ¯”å¦‚ï¼š
```python

visits = {
    'Mexico': {'Tulum', 'Puerto Vallarta'},
    'Japan': {'Hakone'},
}
visits.setdefault('France', set()).add('Arles') # short use

if (japan := visits.get('Japan')) is None : # Long use
    visits['Japan'] = japan = set()
japan.add('Kyoto')
print(visits)
```
å±•å¼€è®²äº†`setdefault` æ–¹æ¡ˆ vs `defaultdict` çš„åŒºåˆ«ï¼Œ`python` å†…ç½®çš„ `collections` æ¨¡å—æä¾›äº†`defaultdict`ç±»ï¼Œå®ƒèƒ½å¤Ÿå®ç°**é”®ç¼ºå¤±çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨æ·»åŠ è¯¥é”®åŠé”®æ‰€å¯¹åº”çš„é»˜è®¤å€¼**ï¼ŒåŒºåˆ« `setdefault` æ–¹æ¡ˆçš„æ˜¯ï¼Œä¸å†é‡å¤åˆ†é… `set`ã€‚
- å¦‚æœå­—å…¸éœ€è¦æ·»åŠ ä»»æ„é”®ï¼Œè€ƒè™‘ä½¿ç”¨å†…ç½®çš„`collections`æ¨¡å—ä¸­çš„`defaultdict`å®ä¾‹æ¥è§£å†³é—®é¢˜ï¼›
- æ”¶åˆ°ä¼ å…¥çš„å­—å…¸é”®åè¾ƒéšæ„ï¼Œæ²¡æœ‰ç”¨ `defauldict` 
